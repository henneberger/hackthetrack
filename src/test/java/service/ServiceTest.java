package service;

import java.io.IOException;
import model.Positions;
import org.codehaus.jackson.map.ObjectMapper;
import org.influxdb.InfluxDB;
import org.influxdb.dto.BatchPoints;
import org.junit.Test;
import static org.mockito.Matchers.any;
import static org.mockito.Mockito.atLeastOnce;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.verify;

/**
 * Created by henneberger on 11/12/16.
 */
public class ServiceTest {

    InfluxDB influxDB = mock(InfluxDB.class);
    @Test
    public void testDiff() throws IOException {
        String s1 = "{\"TrainPositions\":[{\"TrainId\":\"037\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":3150,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":6495,\"ServiceType\":\"NoPassengers\"},{\"TrainId\":\"074\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1571,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":511,\"ServiceType\":\"NoPassengers\"},{\"TrainId\":\"103\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1113,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":5,\"ServiceType\":\"NoPassengers\"},{\"TrainId\":\"105\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":91,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":64,\"ServiceType\":\"NoPassengers\"},{\"TrainId\":\"119\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":1614,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":37,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"145\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":723,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":33950,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"163\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":519,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":33950,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"186\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":523,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":33950,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"224\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":510,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":33950,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"227\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":514,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":33950,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"235\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":513,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":33950,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"303\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":719,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":33950,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"372\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":755,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":11900,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"375\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2494,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":33950,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"410\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2580,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":10233,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"413\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":506,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":33950,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"424\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1162,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":10,\"ServiceType\":\"NoPassengers\"},{\"TrainId\":\"425\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":522,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":33950,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"450\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":504,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":33950,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"451\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":1386,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":16973,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"480\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":756,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":24831,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"481\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":711,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":33950,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"352\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2608,\"DestinationStationCode\":\"G05\",\"LineCode\":\"BL\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"417\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2456,\"DestinationStationCode\":\"G05\",\"LineCode\":\"BL\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"464\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1398,\"DestinationStationCode\":\"G05\",\"LineCode\":\"BL\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"483\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1323,\"DestinationStationCode\":\"G05\",\"LineCode\":\"BL\",\"SecondsAtLocation\":42,\"ServiceType\":\"Normal\"},{\"TrainId\":\"496\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1025,\"DestinationStationCode\":\"G05\",\"LineCode\":\"BL\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"294\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":2709,\"DestinationStationCode\":\"J03\",\"LineCode\":\"BL\",\"SecondsAtLocation\":32,\"ServiceType\":\"Normal\"},{\"TrainId\":\"419\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":2557,\"DestinationStationCode\":\"J03\",\"LineCode\":\"BL\",\"SecondsAtLocation\":32,\"ServiceType\":\"Normal\"},{\"TrainId\":\"429\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1582,\"DestinationStationCode\":\"J03\",\"LineCode\":\"BL\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"490\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1559,\"DestinationStationCode\":\"J03\",\"LineCode\":\"BL\",\"SecondsAtLocation\":943,\"ServiceType\":\"Normal\"},{\"TrainId\":\"494\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1230,\"DestinationStationCode\":\"J03\",\"LineCode\":\"BL\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"016\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1850,\"DestinationStationCode\":\"E10\",\"LineCode\":\"GR\",\"SecondsAtLocation\":42,\"ServiceType\":\"Normal\"},{\"TrainId\":\"067\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1773,\"DestinationStationCode\":\"E10\",\"LineCode\":\"GR\",\"SecondsAtLocation\":21,\"ServiceType\":\"Normal\"},{\"TrainId\":\"116\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":2118,\"DestinationStationCode\":\"E10\",\"LineCode\":\"GR\",\"SecondsAtLocation\":143,\"ServiceType\":\"Normal\"},{\"TrainId\":\"428\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2214,\"DestinationStationCode\":\"E10\",\"LineCode\":\"GR\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"454\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":2056,\"DestinationStationCode\":\"E10\",\"LineCode\":\"GR\",\"SecondsAtLocation\":21,\"ServiceType\":\"Normal\"},{\"TrainId\":\"013\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":2274,\"DestinationStationCode\":\"F11\",\"LineCode\":\"GR\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"022\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1965,\"DestinationStationCode\":\"F11\",\"LineCode\":\"GR\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"038\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":2368,\"DestinationStationCode\":\"F11\",\"LineCode\":\"GR\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"443\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":2016,\"DestinationStationCode\":\"F11\",\"LineCode\":\"GR\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"449\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":2254,\"DestinationStationCode\":\"F11\",\"LineCode\":\"GR\",\"SecondsAtLocation\":26,\"ServiceType\":\"Normal\"},{\"TrainId\":\"509\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":2333,\"DestinationStationCode\":\"F11\",\"LineCode\":\"GR\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"097\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1330,\"DestinationStationCode\":\"D13\",\"LineCode\":\"OR\",\"SecondsAtLocation\":32,\"ServiceType\":\"Normal\"},{\"TrainId\":\"416\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2796,\"DestinationStationCode\":\"D13\",\"LineCode\":\"OR\",\"SecondsAtLocation\":10,\"ServiceType\":\"Normal\"},{\"TrainId\":\"432\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1522,\"DestinationStationCode\":\"D13\",\"LineCode\":\"OR\",\"SecondsAtLocation\":16,\"ServiceType\":\"Normal\"},{\"TrainId\":\"508\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1550,\"DestinationStationCode\":\"D13\",\"LineCode\":\"OR\",\"SecondsAtLocation\":37,\"ServiceType\":\"Normal\"},{\"TrainId\":\"098\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1568,\"DestinationStationCode\":\"K08\",\"LineCode\":\"OR\",\"SecondsAtLocation\":559,\"ServiceType\":\"Normal\"},{\"TrainId\":\"414\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":2932,\"DestinationStationCode\":\"K08\",\"LineCode\":\"OR\",\"SecondsAtLocation\":26,\"ServiceType\":\"Normal\"},{\"TrainId\":\"439\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":3037,\"DestinationStationCode\":\"K08\",\"LineCode\":\"OR\",\"SecondsAtLocation\":10,\"ServiceType\":\"Normal\"},{\"TrainId\":\"486\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1625,\"DestinationStationCode\":\"K08\",\"LineCode\":\"OR\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"006\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":250,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"045\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":326,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":32,\"ServiceType\":\"Normal\"},{\"TrainId\":\"052\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":362,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"055\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":378,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":26,\"ServiceType\":\"Normal\"},{\"TrainId\":\"430\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":232,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":16,\"ServiceType\":\"Normal\"},{\"TrainId\":\"442\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":286,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"457\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":667,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":32,\"ServiceType\":\"Normal\"},{\"TrainId\":\"505\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":209,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":138,\"ServiceType\":\"Normal\"},{\"TrainId\":\"412\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":652,\"DestinationStationCode\":\"B06\",\"LineCode\":\"RD\",\"SecondsAtLocation\":245,\"ServiceType\":\"Normal\"},{\"TrainId\":\"448\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":783,\"DestinationStationCode\":\"B06\",\"LineCode\":\"RD\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"488\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":869,\"DestinationStationCode\":\"B06\",\"LineCode\":\"RD\",\"SecondsAtLocation\":6228,\"ServiceType\":\"Normal\"},{\"TrainId\":\"437\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":587,\"DestinationStationCode\":\"B11\",\"LineCode\":\"RD\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"018\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":701,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":64,\"ServiceType\":\"Normal\"},{\"TrainId\":\"027\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":190,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":48,\"ServiceType\":\"Normal\"},{\"TrainId\":\"048\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":46,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"069\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":115,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"118\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":482,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"411\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":84,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"422\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":13,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"475\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":142,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"489\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":96,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":26,\"ServiceType\":\"Normal\"},{\"TrainId\":\"075\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2838,\"DestinationStationCode\":\"K04\",\"LineCode\":\"SV\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"083\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":3155,\"DestinationStationCode\":\"K04\",\"LineCode\":\"SV\",\"SecondsAtLocation\":980,\"ServiceType\":\"Normal\"},{\"TrainId\":\"104\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":3421,\"DestinationStationCode\":\"N06\",\"LineCode\":\"SV\",\"SecondsAtLocation\":58,\"ServiceType\":\"Normal\"},{\"TrainId\":\"115\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":3418,\"DestinationStationCode\":\"N06\",\"LineCode\":\"SV\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"001\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1193,\"DestinationStationCode\":\"C15\",\"LineCode\":\"YL\",\"SecondsAtLocation\":42,\"ServiceType\":\"Normal\"},{\"TrainId\":\"444\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1169,\"DestinationStationCode\":\"C15\",\"LineCode\":\"YL\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"447\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1940,\"DestinationStationCode\":\"C15\",\"LineCode\":\"YL\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"458\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1220,\"DestinationStationCode\":\"C15\",\"LineCode\":\"YL\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"462\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1901,\"DestinationStationCode\":\"C15\",\"LineCode\":\"YL\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"024\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":967,\"DestinationStationCode\":\"E06\",\"LineCode\":\"YL\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"028\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1763,\"DestinationStationCode\":\"E06\",\"LineCode\":\"YL\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"495\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2241,\"DestinationStationCode\":\"E06\",\"LineCode\":\"YL\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"}]}\n";
        String s2 = "{\"TrainPositions\":[{\"TrainId\":\"033\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":2118,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":15,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"037\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":3150,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":2694,\"ServiceType\":\"NoPassengers\"},{\"TrainId\":\"068\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":1612,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":826,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"145\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":723,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":30149,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"163\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":519,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":30149,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"186\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":523,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":30149,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"224\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":510,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":30149,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"227\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":514,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":30149,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"235\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":513,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":30149,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"303\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":719,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":30149,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"372\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":755,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":8100,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"375\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2494,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":30149,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"410\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2580,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":6432,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"413\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":506,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":30149,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"425\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":522,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":30149,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"450\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":504,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":30149,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"451\",\"CarCount\":0,\"DirectionNum\":1,\"CircuitId\":1386,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":13172,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"464\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":2678,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":11727,\"ServiceType\":\"NoPassengers\"},{\"TrainId\":\"480\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":756,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":21031,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"481\",\"CarCount\":0,\"DirectionNum\":2,\"CircuitId\":711,\"DestinationStationCode\":null,\"LineCode\":null,\"SecondsAtLocation\":30149,\"ServiceType\":\"Unknown\"},{\"TrainId\":\"417\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":976,\"DestinationStationCode\":\"G05\",\"LineCode\":\"BL\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"419\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":1117,\"DestinationStationCode\":\"G05\",\"LineCode\":\"BL\",\"SecondsAtLocation\":229,\"ServiceType\":\"Normal\"},{\"TrainId\":\"429\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1330,\"DestinationStationCode\":\"G05\",\"LineCode\":\"BL\",\"SecondsAtLocation\":58,\"ServiceType\":\"Normal\"},{\"TrainId\":\"490\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2435,\"DestinationStationCode\":\"G05\",\"LineCode\":\"BL\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"294\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1615,\"DestinationStationCode\":\"J03\",\"LineCode\":\"BL\",\"SecondsAtLocation\":170,\"ServiceType\":\"Normal\"},{\"TrainId\":\"352\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1567,\"DestinationStationCode\":\"J03\",\"LineCode\":\"BL\",\"SecondsAtLocation\":575,\"ServiceType\":\"Normal\"},{\"TrainId\":\"483\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1162,\"DestinationStationCode\":\"J03\",\"LineCode\":\"BL\",\"SecondsAtLocation\":21,\"ServiceType\":\"Normal\"},{\"TrainId\":\"494\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2574,\"DestinationStationCode\":\"J03\",\"LineCode\":\"BL\",\"SecondsAtLocation\":37,\"ServiceType\":\"Normal\"},{\"TrainId\":\"496\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1285,\"DestinationStationCode\":\"J03\",\"LineCode\":\"BL\",\"SecondsAtLocation\":53,\"ServiceType\":\"Normal\"},{\"TrainId\":\"013\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1824,\"DestinationStationCode\":\"E10\",\"LineCode\":\"GR\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"022\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1895,\"DestinationStationCode\":\"E10\",\"LineCode\":\"GR\",\"SecondsAtLocation\":1099,\"ServiceType\":\"Normal\"},{\"TrainId\":\"038\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":2208,\"DestinationStationCode\":\"E10\",\"LineCode\":\"GR\",\"SecondsAtLocation\":31,\"ServiceType\":\"Normal\"},{\"TrainId\":\"443\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2134,\"DestinationStationCode\":\"E10\",\"LineCode\":\"GR\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"509\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1746,\"DestinationStationCode\":\"E10\",\"LineCode\":\"GR\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"016\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":2342,\"DestinationStationCode\":\"F11\",\"LineCode\":\"GR\",\"SecondsAtLocation\":85,\"ServiceType\":\"Normal\"},{\"TrainId\":\"067\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1967,\"DestinationStationCode\":\"F11\",\"LineCode\":\"GR\",\"SecondsAtLocation\":10,\"ServiceType\":\"Normal\"},{\"TrainId\":\"428\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":2009,\"DestinationStationCode\":\"F11\",\"LineCode\":\"GR\",\"SecondsAtLocation\":42,\"ServiceType\":\"Normal\"},{\"TrainId\":\"449\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":2055,\"DestinationStationCode\":\"F11\",\"LineCode\":\"GR\",\"SecondsAtLocation\":79,\"ServiceType\":\"Normal\"},{\"TrainId\":\"454\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":2299,\"DestinationStationCode\":\"F11\",\"LineCode\":\"GR\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"432\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2855,\"DestinationStationCode\":\"D13\",\"LineCode\":\"OR\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"439\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":1500,\"DestinationStationCode\":\"D13\",\"LineCode\":\"OR\",\"SecondsAtLocation\":37,\"ServiceType\":\"Normal\"},{\"TrainId\":\"486\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1105,\"DestinationStationCode\":\"D13\",\"LineCode\":\"OR\",\"SecondsAtLocation\":85,\"ServiceType\":\"Normal\"},{\"TrainId\":\"497\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1389,\"DestinationStationCode\":\"D13\",\"LineCode\":\"OR\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"414\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":1624,\"DestinationStationCode\":\"K08\",\"LineCode\":\"OR\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"416\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1559,\"DestinationStationCode\":\"K08\",\"LineCode\":\"OR\",\"SecondsAtLocation\":629,\"ServiceType\":\"Normal\"},{\"TrainId\":\"470\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":3063,\"DestinationStationCode\":\"K08\",\"LineCode\":\"OR\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"508\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":2939,\"DestinationStationCode\":\"K08\",\"LineCode\":\"OR\",\"SecondsAtLocation\":111,\"ServiceType\":\"Normal\"},{\"TrainId\":\"018\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":237,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"027\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":306,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"055\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":6,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":293,\"ServiceType\":\"Normal\"},{\"TrainId\":\"069\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":362,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"404\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":263,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"411\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":681,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"457\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":227,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"475\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":336,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":21,\"ServiceType\":\"Normal\"},{\"TrainId\":\"489\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":389,\"DestinationStationCode\":\"A15\",\"LineCode\":\"RD\",\"SecondsAtLocation\":26,\"ServiceType\":\"Normal\"},{\"TrainId\":\"437\",\"CarCount\":8,\"DirectionNum\":2,\"CircuitId\":808,\"DestinationStationCode\":\"B06\",\"LineCode\":\"RD\",\"SecondsAtLocation\":26,\"ServiceType\":\"Normal\"},{\"TrainId\":\"488\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":869,\"DestinationStationCode\":\"B06\",\"LineCode\":\"RD\",\"SecondsAtLocation\":2428,\"ServiceType\":\"Normal\"},{\"TrainId\":\"412\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":566,\"DestinationStationCode\":\"B11\",\"LineCode\":\"RD\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"448\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":652,\"DestinationStationCode\":\"B11\",\"LineCode\":\"RD\",\"SecondsAtLocation\":90,\"ServiceType\":\"Normal\"},{\"TrainId\":\"006\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":109,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"045\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":62,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":15,\"ServiceType\":\"Normal\"},{\"TrainId\":\"048\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":699,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"052\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":24,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"422\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":467,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":47,\"ServiceType\":\"Normal\"},{\"TrainId\":\"430\",\"CarCount\":8,\"DirectionNum\":1,\"CircuitId\":133,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":53,\"ServiceType\":\"Normal\"},{\"TrainId\":\"442\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":90,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"505\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":164,\"DestinationStationCode\":\"B35\",\"LineCode\":\"RD\",\"SecondsAtLocation\":42,\"ServiceType\":\"Normal\"},{\"TrainId\":\"007\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":3156,\"DestinationStationCode\":\"K04\",\"LineCode\":\"SV\",\"SecondsAtLocation\":837,\"ServiceType\":\"Normal\"},{\"TrainId\":\"044\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":3251,\"DestinationStationCode\":\"K04\",\"LineCode\":\"SV\",\"SecondsAtLocation\":10,\"ServiceType\":\"Normal\"},{\"TrainId\":\"063\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":3312,\"DestinationStationCode\":\"N06\",\"LineCode\":\"SV\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"075\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":3417,\"DestinationStationCode\":\"N06\",\"LineCode\":\"SV\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"024\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1136,\"DestinationStationCode\":\"C15\",\"LineCode\":\"YL\",\"SecondsAtLocation\":1726,\"ServiceType\":\"Normal\"},{\"TrainId\":\"028\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":3135,\"DestinationStationCode\":\"C15\",\"LineCode\":\"YL\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"447\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1188,\"DestinationStationCode\":\"C15\",\"LineCode\":\"YL\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"462\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":945,\"DestinationStationCode\":\"C15\",\"LineCode\":\"YL\",\"SecondsAtLocation\":0,\"ServiceType\":\"Normal\"},{\"TrainId\":\"495\",\"CarCount\":6,\"DirectionNum\":2,\"CircuitId\":1947,\"DestinationStationCode\":\"C15\",\"LineCode\":\"YL\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"001\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1052,\"DestinationStationCode\":\"E06\",\"LineCode\":\"YL\",\"SecondsAtLocation\":26,\"ServiceType\":\"Normal\"},{\"TrainId\":\"424\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":1782,\"DestinationStationCode\":\"E06\",\"LineCode\":\"YL\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"},{\"TrainId\":\"444\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":2241,\"DestinationStationCode\":\"E06\",\"LineCode\":\"YL\",\"SecondsAtLocation\":31,\"ServiceType\":\"Normal\"},{\"TrainId\":\"458\",\"CarCount\":6,\"DirectionNum\":1,\"CircuitId\":988,\"DestinationStationCode\":\"E06\",\"LineCode\":\"YL\",\"SecondsAtLocation\":5,\"ServiceType\":\"Normal\"}]}\n";

        Service service = new Service(influxDB);
        service.diffStations(new ObjectMapper().readValue(s1, Positions.class));
        service.diffStations(new ObjectMapper().readValue(s2, Positions.class));

        verify(influxDB, atLeastOnce()).write(any(BatchPoints.class));

    }

}